<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#">
<head>
<title>Emporyou marketplace</title>
<meta charset="utf-8"/>
<!--
            `:+syhdddddhys+:.            
        -odmmhs+/:::::/+shmmdo:`        
     `+dmdo:`             `-odmd+`      
   `+dmy:                     :ymd+`    
  .ymd:                         :dmy.   
 .hmy```````````````             `ymd.  
 ymh` /dddddddddddd+              `hmy  
:mm:  `------------.               -mm: 
omd                                 dms 
smd                                 dmy 
omm`                               `mmo 
.mm+               :++++++++++++.  /mm- 
 omm-              /yyyyyyyyyyyy- -dmo  
 `smd:                           :dms`  
   +mms.                       .omm+`   
    .smds-                   -odms-     
      -odmho:.`         `.:ohmdo-       
        `-oydmdhyssossyhdmdyo:`         
            `.:/+ossso+/:.`             
                                        
    -+:o/`   `:          :        s`    
o/o+sooy+s/o:-s:s/s-yso .d-osy-yo`d`oso 
+/+:/::+-o:o:-o:/`s.o/.  s:/+/`/o-s-s/o -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/main.css">
<link rel="stylesheet" type="text/css" href="css/digital.css">
<link rel="stylesheet" type="text/css" href="css/cart.css">
<link rel="stylesheet" type="text/css" href="css/thumbs.css">
<link rel="stylesheet" type="text/css" href="css/product-page.css">
<link rel="stylesheet" type="text/css" href="css/info-prod.css">
<link rel="stylesheet" type="text/css" href="css/checkout.css">
<link rel="stylesheet" type="text/css" href="css/nouislider.min.css">
<link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Josefin+Sans&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<script src="js/checkout.js"></script>
<script src="js/main.js"></script>
<script src="js/mainh.js"></script>
<script src="js/nouislider.min.js"></script>
<script src="js/metaschema.js"></script>
<!--<script type="text/javascript" src="https://cdn.rawgit.com/metaschema/browser/master/metaschema.js"></script>-->
<!--<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>-->
<script src="js/jquery.geocomplete.js"></script>
<meta name=viewport content="width=device-width, initial-scale=1">
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<meta name="description" content="" />
<meta name="keywords" content="" />
    <script>
			window.initialjdata={};
        try{var ttt=replace_jdata;initialjdata.doc=[ttt]}
		  catch(ex){window.initialjdata=false};
		  if(!window.initialjdata.doc){window.initialjdata=false}
    </script>
<script>
myappinit=function(){
	ooo.render('cat-search', 'category-template.xml', 'http://emporyou.com/api/get?k=50&output=xml', false, 'append')
   ooo.render('check-login','http://emporyou.com/checkout-template.xml','http://emporyou.com/session',false,checkLogin());
	ooo.render('cart-data','html.xml','../syncart',false,false,function(){setTimeout(rendercart,100)});	
	window.addEventListener('resize', checkMobile);
	checkMobile();
	doinitialrender();
   var slider = document.getElementById('slider-search');

noUiSlider.create(slider, {
	start: [ 0, 250 ],
	snap: true,
	connect: true,
	range: {
		'min': 0,
		'10%': 20,
		'20%': 50,
		'30%': 100,
		'40%': 150,
		'50%': 200,
        '60%': 500,
        '70%': 750,
		'max': 1000
	}
});

slider.noUiSlider.on('update', function( values, handle ) {
	var value = values[handle];
	if ( handle ) {
		document.getElementById('jfind-max').value = Math.round(value);setdeferredupdate();
	} else {
		document.getElementById('jfind-min').value = Math.round(value);setdeferredupdate();
	}
});
document.getElementById('jfind-max').addEventListener('change', function(){
	slider.noUiSlider.set([this.value, null]);setdeferredupdate();
});

document.getElementById('jfind-min').addEventListener('change', function(){
	slider.noUiSlider.set([null, this.value]);setdeferredupdate();
});
	//setTimeout('initMap()',500);
  // Option 1: Call on element.
  /*
$.fn.geocomplete("input"); // Option 2: Pass element as argument.
    $("#city-input").geocomplete({
	map: "#google-map"
});*/
}

window.deferredhandler=false;
setdeferredupdate=function(){
	if(deferredhandler){clearTimeout(deferredhandler)}
	deferredhandler=setTimeout(function(){updateProductList()},250)
};
window.ISptloaded=false;
doinitialrender=function(){
	if(window.initialjdata){
		if(window.initialjdata.doc[0].PREVIEWdetails){
			if(!window.ISptloaded){ooo.preload('product-page-template.xml',function(){window.ISptloaded=true;setTimeout('doinitialrender();',250)})}
			else{
			var ttt=ooo.parsexml('<tmpdoc>'+ooo.preloaded('product-page-template.xml').documentElement.innerHTML+'</tmpdoc>');
			productOpened=1;ooo.syncrender('product-page-target',ttt,window.initialjdata);}
		}else{
	if(!window.ISptloaded){ooo.preload('products-template.xml',function(){window.ISptloaded=true;setTimeout('doinitialrender();',250)})}
	else{
		var ttt=ooo.parsexml('<tmpdoc>'+ooo.preloaded('products-template-uni.xml').documentElement.innerHTML+'</tmpdoc>');
		ooo.syncrender('thumb-wrap',ttt.documentElement,window.initialjdata);
	}}}
	else{
		//ooo.render('thumb-wrap','products-template-uni.xml','http://emporyou.com/api/get?k=12&');
	}
};

</script>
<script>
    function checkLogin(){
        setTimeout("window.ch=document.getElementById('check-login').innerHTML;chooseStart()",500)
    }
    function chooseStart(){console.log(ch+' is ch');
    if(ch=='guest'){document.getElementById('pre-notlogged').click()}else{document.getElementById('next-logged').click();ooo.render('profile-button','usrheader.xml','http://emporyou.com/session'); }
                        fillAddress();  
    }
    function fillAddress(){
        ooo.render('form-target','address.xml','http://emporyou.com/session');
        
        
    }
</script>
<script>
window.mapcenter={lat: 40.674, lng: -73.946}
initMap=function() {    
  var customMapType = new google.maps.StyledMapType(getmapstyle(), {
      name: 'Mappa delle offerte | trascina il pallocino rosso per cambiare la zona di ricerca, usa lo zoom per cambiare l\' ampiezza.'
  });
  var customMapTypeId = 'emporyou_style';
  var mapOpts={
    zoom: 12,
    mapTypeControlOptions: {
	  mapTypeIds: [customMapTypeId]
      //mapTypeIds: [google.maps.MapTypeId.ROADMAP, customMapTypeId]
    }
  };
  //window.gmap=new google.maps.Map(document.getElementById('main-google-map'),mapOpts);
  window.ismaploadedonce=true;
  $("#city-input").geocomplete({
	location:'Milano',
	map:"#main-google-map",
	//details:'.georesults',
	mapOptions:mapOpts,
	markerOptions:{draggable: true}
  })
  .bind("geocode:result", function(event, result){
    console.log(result);
		ooo.$$("jfind-lat").value=result.geometry.location.lat();
      ooo.$$("jfind-lng").value=result.geometry.location.lng();
		updateProductList()
  });
  $("#city-input").bind("geocode:dragged", function(event, latLng){
		//console.log(latLng.lat()+','+latLng.lng());
		ooo.$$("jfind-lat").value=latLng.lat();
      ooo.$$("jfind-lng").value=latLng.lng();
		window.gmap.setCenter(latLng);
		updateProductList()
      //$("#city-input").val(latLng.lat()+','+latLng.lng());
		//$("#city-input").trigger("geocode");
  });
  window.gmap=$("#city-input").geocomplete('map');
  window.gmap.mapTypes.set(customMapTypeId, customMapType);
  window.gmap.setMapTypeId(customMapTypeId);
  
  // Construct the circle for each value in citymap.
  // Note: We scale the area of the circle based on the population.
  /*for (var city in citymap) {
    // Add the circle for this city to the map.
    var cityCircle = new google.maps.Circle({
      strokeColor: '#FF0000',
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillColor: '#FF0000',
      fillOpacity: 0.35,
      map: map,
      center: citymap[city].center,
      radius: Math.sqrt(citymap[city].population) * 100
    });
  }*/
  
};</script>
</head>
<body onload="myappinit();" onresize="checkMobile()" class="Bmode">
<!-- ---------------------------------------------------------------------------- MAIN BAR -->
<div class="header">
<div class="language-select">IT ▼</div>
	<button onclick="document.body.classList.toggle('cat-isin');"><i class="-b menu fa fa-bars"></i></button>
   <div class="logo-text-sx"></div>
    <div id="profile-button" onclick="window.location.href='../user/profile.html'">Accedi</div>
   <div class="fontlogo text-logo"><img class="logo-text" onclick="window.location.href='http://emporyou.com'" src="../img/logo-text.png"/></div>
    <div class="logo-container"><!--<img
        class="logo" src="../img/logo-white.png" onclick="defaultPage();setTimeout('defaultPage()',200)"/>--></div></div>
<!-- ------------------------------------------------------------------------------ BASKET -->
<img id="basket" src="../img/basket.png" onclick="toggleCart()" class="transition-S"/>
<img id="rope" src="../img/rope.png" onclick="toggleCart()" class="transition-S"/>
<div id="bought-container" style="display:none"><a class="flag" href="#" onclick="javascript:toggleCart();return false;"><div id="flag-text" class="flag-text">1</div></a></div>
<!-- ---------------------------------------------------------------- GOOGLE MAP CONTAINER -->
<div id="google-map-container" class="google-map-container transition-3"><div id="main-google-map" class="google-map"></div></div>
<!-- --------------------------------------------------------------- PRODUCT THUMBS TARGET -->
<div id="categories-container" class="categories-container transition-3">
      <div class="cat-searchbar transition-1" id="cat-searchbar">
          <div id="search">
          	<fieldset class="clearfix">
					<input type="search" name="search" value="Cosa stai cercando?" onBlur="if(this.value=='')this.value='Cosa stai cercando?'" onFocus="if(this.value=='Cosa stai cercando?')this.value='' ">
					<input type="submit" value="Cerca" class="button">
				</fieldset>
          </div>
      </div>
       <div class="cat-cont transition-1" id="cat-city" onclick="ensureMapIsOpened();openCat(this)">Città</div>
       <div id="city-search" class="search transition-1"><form id="georesults" class="georesults">
           <input type="text" name="formatted_address" id="city-input" placeholder="città,zona o indirizzo..." style="    font-size: 2.7vh;padding: 1vh;width: 90%;"/>
			  <input id="jfind-lat" name="lat" type="hidden" value=""><input id="jfind-lng" name="lng" type="hidden" value=""></form>
       </div>
       <div class="cat-cont transition-1" id="cat-price"  onclick="openCat(this)">Fascia di prezzo</div>
       <div id="price-search" class="search transition-1">
           <div id="slider-search"></div><input value="0" min="0" type="number" id="jfind-min"/><input value="250" min="0" type="number" id="jfind-max"/>
       </div>
       <div class="cat-cont transition-1" id="cat-category"  onclick="openCat(this)">Categoria</div>
       <div id="cat-search" class="search transition-1">
       </div>
       <div class="cat-cont transition-1" id="cat-ordina"  onclick="openCat(this)">Ordina per</div>
       <div id="ordina-search" class="search transition-1">
	<label>
    <select>
        <option selected>...</option>
        <option>Prezzo crescente</option>
        <option>Prezzo decrescente</option>
        <option>Popolarità</option>
        <option>Vicinanza</option>
        <option>Percentuale di sconto</option>
    </select>
</label>
       </div>
   </div>
<!-- --------------------------------------------------------------- PRODUCT THUMBS TARGET -->
<div id="product-main-container" class="products-main transition-3">
    <div class="products-container"><div id="thumb-wrap"> </div></div>
</div>
<!-- ---------------------------------------------------------------------- CHECKOUT START -->
<div id="checkout-main-container">
    <div id="checkout-progress-container"><div id="progress-bar" class="uno transition-1"></div><div class="step" id="step-login">Login</div><div class="step" id="step-address">Address</div><div class="step" id="step-shipping">Shipping</div><div class="step" id="step-review">Review</div><div class="step" id="step-complete">Complete</div></div>
    <div class="menu-opened transition-1">
        <div class="left-square open transition-1" id="checkout-login">
            <div class="single-container" id="single-login">
                <div class="single-header">Login account</div>
                <div class="single-content">
                    <a href="login.html" class="login-button-checkout transition-1" target="_blank">Login</a>
                    <div id="button-social-container">
                        <div class="social-logo">Google</div>
                        <div class="social-logo">Facebook</div>
                        <div class="social-logo">Twitter</div>
                        <div class="social-logo">Shopify</div>
                        <div class="social-logo">Amazon</div>
                    </div>
                </div>
                <div class="next transition-1" id="next-logged" onclick="stepCheckout(document.getElementById('checkout-address'));var now=40;progressBar('next',now)">
                    <img src="img/next.png" class="next-image image-button transition-1"/>
                </div>
            </div>
            <div class="circle-step">1</div>            
        </div>
        <div class="left-square closed transition-1"  id="checkout-address">
            <div class="single-container" id="single-address"  style="display:none">
                <div class="single-header">Choose shipping and billing address</div>
                <div class="single-content">
                    <form id="form-target">
                        <textarea class="text-address" placeholder="Country.." id="country-textarea"></textarea>
                        <textarea class="text-address" placeholder="Full Name.." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="Address.." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="Address.." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="ZIP code..." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="City.." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="Region.." id="country-textaera"></textarea>
                        <textarea class="text-address" placeholder="Phone" id="country-textaera"></textarea>
                    </form>
                </div>
                 <div class="next transition-1" onclick="stepCheckout(document.getElementById('checkout-shipping'));var now=60;progressBar('next',now)">
                     <img src="img/next.png" class="next-image image-button transition-1"/>
                 </div>
                 <div class="pre transition-1" id="pre-notlogged" onclick="stepCheckout(document.getElementById('checkout-login'));var now=20;progressBar('pre',now)">
                     <img src="img/next.png" class="pre-image image-button transition-1"/>
                 </div>
            </div>
            <div class="circle-step">2</div>
        </div>
        <div class="left-square closed transition-1"  id="checkout-shipping">
            <div class="single-container" id="single-shipping"  style="display:none">
                <div class="single-header">Shipping options</div>
                <div class="single-content">
                    <div class="shipping-option">Free</div>
                       <div class="shipping-option">Standard</div>
                       <div class="shipping-option">Priority</div>
                </div>
                <div class="next transition-1" onclick="stepCheckout(document.getElementById('checkout-review'));var now=80;progressBar('next',now)">
                    <img src="img/next.png" class="next-image image-button transition-1"/>
                </div>
                <div class="pre transition-1" onclick="stepCheckout(document.getElementById('checkout-address'));var now=40;progressBar('pre',now)">
                    <img src="img/next.png" class="pre-image image-button transition-1"/>
                </div>
            </div>
            <div class="circle-step">3</div>
        </div>
    </div>
    <div class="menu-closed transition-1">
        <div class="left-square closed transition-1"  id="checkout-review">
            <div class="single-container" id="single-review"  style="display:none">
                <div class="single-header">Review your order</div>
                <div class="single-content" id="checkout-target"></div>
                <div class="next transition-1" onclick="stepCheckout(document.getElementById('checkout-complete'));var now=120;progressBar('next',now)">
                    <img src="img/next.png" class="next-image image-button transition-1"/>
                </div>
                <div class="pre transition-1" onclick="stepCheckout(document.getElementById('checkout-shipping'));var now=60;progressBar('pre',now)">
                    <img src="img/next.png" class="pre-image image-button transition-1"/>
                </div>
            </div>
            <div class="circle-step">4</div>
        </div>
        <div class="left-square closed transition-1" id="checkout-complete">
            <div class="single-container" id="single-complete"  style="display:none">
                <div class="single-header">Complete and pay</div>
                <div class="single-content">
                    <img id="paypal-button" src="https://www.paypal.com/en_US/i/btn/btn_xpressCheckout.gif" align="left" style="margin-right:7px;">
                    <button onclick="window.location.href='../user/success.html'">Simula transazione riuscita</button><button onclick="window.location.href='../user/failed.html'">Simula transazione fallita</button>
                </div>
                <div class="pre transition-1" onclick="stepCheckout(document.getElementById('checkout-review'));var now=80;progressBar('pre',now)">
                    <img src="img/next.png" class="pre-image image-button transition-1"/>
                </div>
            </div>
            <div class="circle-step">5</div>
        </div>
    </div>
    <div id="checkout-address-container"></div>
    <div id="quit-checkout" onclick="closeCheckout()">BACK</div>
</div>
<!-- ------------------------------------------------------------------- CART TARGET START -->
<div id="products-cart-target" class="transition-3"> </div>
<!-- ----------------------------------------------------------------- HIDDEN STUFF START -->
<div id="check-login" style="display:none"></div>
<div id="cart-data" style="display:none"></div>
</body></html>